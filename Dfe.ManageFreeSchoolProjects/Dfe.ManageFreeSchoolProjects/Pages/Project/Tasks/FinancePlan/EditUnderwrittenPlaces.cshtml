@page "/projects/{projectId}/tasks/finance-plan/underwritten-places/edit"
@using Dfe.ManageFreeSchoolProjects.API.Contracts.Common
@using Dfe.ManageFreeSchoolProjects.API.Contracts.Project.Tasks
@using Dfe.ManageFreeSchoolProjects.Constants;
@model Dfe.ManageFreeSchoolProjects.Pages.Project.Tasks.FinancePlan.EditUnderwrittenPlacesModel
@{
    ViewData["Title"] = $"Local authority underwriting pupil numbers - {Model.SchoolName}";

    var backlink = string.Format(RouteConstants.EditFinancePlanTask, Model.ProjectId);

    var yesNoNotApplicableLabels  = new[] { "Yes", "No", "Not applicable" };
    var yesNoNotApplicableValues = new[] { YesNoNotApplicable.Yes.ToString(), YesNoNotApplicable.No.ToString(), YesNoNotApplicable.NotApplicable.ToString() };
    var localAuthorityAgreedTestIds = yesNoNotApplicableValues.Select(v => $"local-authority-agreed-{v}").ToArray();
}
@section BeforeMain {
    <div role="navigation" class="govuk-width-container msfp-wider-page">
        <a href=@backlink class="govuk-back-link">Back</a>
    </div>
}

<partial name="_ErrorSummary" />

<h1 class="govuk-heading-xl" data-testid="title">
    <span class="govuk-caption-l" data-testid="school-name">@Model.SchoolName</span>
    Local authority underwriting pupil numbers
</h1>

<govuk-summary-list>
    <div class="govuk-summary-list__row--no-border">
        <dt class="govuk-summary-list__key">
            School phase
        </dt>
        <dd class="govuk-summary-list__value">
            @Model.SchoolPhase.ToDescription()
        </dd>
    </div>
</govuk-summary-list>

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

        <form method="post">
            @Html.HiddenFor(m => m.SchoolName)
            @{
            if (Model.SchoolPhase == SchoolPhase.Primary)
            {
                <div class="govuk-form-group govuk-!-margin-bottom-9">
                    <h1 class="govuk-heading-l" data-testid="title">
                        Provide the total number of underwritten places
                    </h1>
                    <govuk-number-input-cell id="primary-year-1-places" name="primary-year-1-places" asp-for="@Model.PrimaryYear1Places" label="First year of opening" suffix="places" />
                    <govuk-number-input-cell id="primary-year-2-places" name="primary-year-2-places" asp-for="@Model.PrimaryYear2Places" label="Second year of opening" suffix="places" />
                    <govuk-number-input-cell id="primary-year-3-places" name="primary-year-3-places" asp-for="@Model.PrimaryYear3Places" label="Third year of opening" suffix="places" />
                    <govuk-number-input-cell id="primary-year-4-places" name="primary-year-4-places" asp-for="@Model.PrimaryYear4Places" label="Fourth year of opening" suffix="places" />
                    <govuk-number-input-cell id="primary-year-5-places" name="primary-year-5-places" asp-for="@Model.PrimaryYear5Places" label="Fifth year of opening" suffix="places" />
                    <govuk-number-input-cell id="primary-year-6-places" name="primary-year-6-places" asp-for="@Model.PrimaryYear6Places" label="Sixth year of opening" suffix="places" />
                    <govuk-number-input-cell id="primary-year-7-places" name="primary-year-7-places" asp-for="@Model.PrimaryYear7Places" label="Seventh year of opening" suffix="places" />
                </div>
            }

            if (Model.SchoolPhase == SchoolPhase.Secondary)
            {
                <div class="govuk-form-group govuk-!-margin-bottom-9">
                    <h1 class="govuk-heading-l" data-testid="title">
                        Provide the total number of underwritten places
                    </h1>
                    <govuk-number-input-cell id="secondary-year-1-places" name="secondary-year-1-places" asp-for="@Model.SecondaryYear1Places" label="First year of opening" suffix="places" />
                    <govuk-number-input-cell id="secondary-year-2-places" name="secondary-year-2-places" asp-for="@Model.SecondaryYear2Places" label="Second year of opening" suffix="places" />
                    <govuk-number-input-cell id="secondary-year-3-places" name="secondary-year-3-places" asp-for="@Model.SecondaryYear3Places" label="Third year of opening" suffix="places" />
                    <govuk-number-input-cell id="secondary-year-4-places" name="secondary-year-4-places" asp-for="@Model.SecondaryYear4Places" label="Fourth year of opening" suffix="places" />
                    <govuk-number-input-cell id="secondary-year-5-places" name="secondary-year-5-places" asp-for="@Model.SecondaryYear5Places" label="Fifth year of opening" suffix="places" />
                </div>
            }

            if (Model.SchoolPhase == SchoolPhase.SixteenToNineteen)
            {
                <div class="govuk-form-group govuk-!-margin-bottom-9">
                    <h1 class="govuk-heading-l" data-testid="title">
                        Provide the total number of underwritten places
                    </h1>
                    <govuk-number-input-cell id="sixteen-to-nineteen-year-1-places" name="sixteen-to-nineteen-year-1-places" asp-for="@Model.SixteenToNineteenYear1Places" label="First year of opening" suffix="places" />
                    <govuk-number-input-cell id="sixteen-to-nineteen-year-2-places" name="sixteen-to-nineteen-year-2-places" asp-for="@Model.SixteenToNineteenYear2Places" label="Second year of opening" suffix="places" />
                    <govuk-number-input-cell id="sixteen-to-nineteen-year-3-places" name="sixteen-to-nineteen-year-3-places" asp-for="@Model.SixteenToNineteenYear3Places" label="Third year of opening" suffix="places" />
                </div>
            }

                if (Model.SchoolPhase == SchoolPhase.AllThrough || Model.SchoolPhase == SchoolPhase.NotSet)
                {
                    <div class="govuk-form-group govuk-!-margin-bottom-9">
                        <h1 class="govuk-heading-l" data-testid="title">
                            Provide the total number of underwritten primary places
                        </h1>
                        <govuk-number-input-cell id="primary-year-1-places" name="primary-year-1-places" asp-for="@Model.PrimaryYear1Places" label="First year of opening" suffix="places" />
                        <govuk-number-input-cell id="primary-year-2-places" name="primary-year-2-places" asp-for="@Model.PrimaryYear2Places" label="Second year of opening" suffix="places" />
                        <govuk-number-input-cell id="primary-year-3-places" name="primary-year-3-places" asp-for="@Model.PrimaryYear3Places" label="Third year of opening" suffix="places" />
                        <govuk-number-input-cell id="primary-year-4-places" name="primary-year-4-places" asp-for="@Model.PrimaryYear4Places" label="Fourth year of opening" suffix="places" />
                        <govuk-number-input-cell id="primary-year-5-places" name="primary-year-5-places" asp-for="@Model.PrimaryYear5Places" label="Fifth year of opening" suffix="places" />
                        <govuk-number-input-cell id="primary-year-6-places" name="primary-year-6-places" asp-for="@Model.PrimaryYear6Places" label="Sixth year of opening" suffix="places" />
                        <govuk-number-input-cell id="primary-year-7-places" name="primary-year-7-places" asp-for="@Model.PrimaryYear7Places" label="Seventh year of opening" suffix="places" />
                    </div>

                    <div class="govuk-form-group govuk-!-margin-bottom-9">
                        <h1 class="govuk-heading-l" data-testid="title">
                            Provide the total number of underwritten secondary places
                        </h1>
                        <govuk-number-input-cell id="secondary-year-1-places" name="secondary-year-1-places" asp-for="@Model.SecondaryYear1Places" label="First year of opening" suffix="places" />
                        <govuk-number-input-cell id="secondary-year-2-places" name="secondary-year-2-places" asp-for="@Model.SecondaryYear2Places" label="Second year of opening" suffix="places" />
                        <govuk-number-input-cell id="secondary-year-3-places" name="secondary-year-3-places" asp-for="@Model.SecondaryYear3Places" label="Third year of opening" suffix="places" />
                        <govuk-number-input-cell id="secondary-year-4-places" name="secondary-year-4-places" asp-for="@Model.SecondaryYear4Places" label="Fourth year of opening" suffix="places" />
                        <govuk-number-input-cell id="secondary-year-5-places" name="secondary-year-5-places" asp-for="@Model.SecondaryYear5Places" label="Fifth year of opening" suffix="places" />
                    </div>

                    <div class="govuk-form-group govuk-!-margin-bottom-9">
                        <h1 class="govuk-heading-l" data-testid="title">
                            Provide the total number of underwritten 16 to 19 places
                        </h1>
                        <govuk-number-input-cell id="sixteen-to-nineteen-year-1-places" name="sixteen-to-nineteen-year-1-places" asp-for="@Model.SixteenToNineteenYear1Places" label="First year of opening" suffix="places" />
                        <govuk-number-input-cell id="sixteen-to-nineteen-year-2-places" name="sixteen-to-nineteen-year-2-places" asp-for="@Model.SixteenToNineteenYear2Places" label="Second year of opening" suffix="places" />
                        <govuk-number-input-cell id="sixteen-to-nineteen-year-3-places" name="sixteen-to-nineteen-year-3-places" asp-for="@Model.SixteenToNineteenYear3Places" label="Third year of opening" suffix="places" />
                    </div>
                }

                <govuk-checkbox-input id="confirmation-from-local-authority-saved-in-workplaces-folder" name="confirmation-from-local-authority-saved-in-workplaces-folder" asp-for="@Model.ConfirmationFromLocalAuthoritySavedInWorkplacesFolder" heading-label="Confirmation from local authority saved in workplaces folder" label="Done" />
                <govuk-textarea-input id="comments-about-underwritten-places" label="Add comments about underwritten places" hint="Optional" rows="5" bold-label="true" name="comments-about-underwritten-places" asp-for="@Model.CommentsAboutUnderwrittenPlaces" add-margin="true" data-testid="comments-about-underwritten-places" />
            }
            <button class="govuk-button" data-module="govuk-button" data-testid="continue">
                Save and continue
            </button>
        </form>

    </div>
</div>